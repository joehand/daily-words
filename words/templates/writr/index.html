{% extends "writr/_writr_base.html" %}

{%- block content -%}
<h3>Writr Dashboard</h3>
<a href="{{url_for('.write')}}">Write Today</a>
<img src="{{current_user.avatar(64)}}"/>
{{g.streak}}

{% for item in items%}
{% if item.content %}
<div class="item" data-id="{{item.id}}">
    {{item.reached_goal()}}
    {%set date = item.date|format_date('%d-%b-%Y')%}
    <a href="{{url_for('.item', date=date)}}">{{item.date|format_date('%d %b %Y')}}</a>
    {{item.word_count()}}
    {{item.writing_time()}}
</div>
{% endif %}
{% endfor %}
{%- endblock -%}

{%- block footer_js %}
    <script>
        var {{ config.PROJECT }} = {},
            NAMESPACE = {{ config.PROJECT }}; //namespace everything under here.
        {{ config.PROJECT }}.user = {
                                'id'     : '{{current_user.id}}',
                                'email'  : '{{current_user.email}}'
                            };
        {{ config.PROJECT }}.itemsBootstrap = [{% for item in items%}{{item.to_dict()|tojson|safe}},{% endfor %}];
        {{ config.PROJECT }}.apiURL = "{{url_for('writr.ItemAPI:index')}}";
        {{ config.PROJECT }}.childView = null;
    </script>
    <script data-main="{{ url_for('static', filename='js/config')}}" src="{{ url_for('static', filename='ext/requirejs/require.js')}}"></script>
{%- endblock footer_js %}
